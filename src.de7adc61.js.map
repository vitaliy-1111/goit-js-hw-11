{"version":3,"sources":["js/getRefs.js","js/picture-service.js","js/components/load-more-btn.js","index.js"],"names":["getRefs","searchFormEl","document","querySelector","loadMoreBtnEl","gallery","API_KEY","BASE_URL","PictureApiService","constructor","searchQuery","page","fetchPictures","url","fetch","then","response","json","query","newQuery","incrementPage","resetPage","LoadMoreBtn","selector","hidden","refs","hide","button","label","spinner","enable","disabled","textContent","classList","add","disable","remove","show","pictureApiService","loadMoreBtn","onSubmitSearchForm","e","preventDefault","console","log","currentTarget","elements","value","clearGalleryContainer","hits","totalHits","renderPicturesCard","countries","length","innerHTML","markup","map","country","webformatURL","tags","likes","views","comments","downloads","join","insertAdjacentHTML","onLoadMoreBtn","addEventListener"],"mappings":"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","file":"src.de7adc61.js","sourceRoot":"../src","sourcesContent":["export default function getRefs() {\n  return {\n    searchFormEl: document.querySelector('#search-form'),\n    loadMoreBtnEl: document.querySelector('.load-more'),\n    gallery: document.querySelector('.gallery')\n  }\n}","const API_KEY = '25242502-f78164f0bc2e44d564a196c5b';\nconst BASE_URL = 'https://pixabay.com/api';\n\nexport default class PictureApiService {\n  constructor() {\n    this.searchQuery = '';\n    this.page = 1;\n    \n  }\n\n  fetchPictures() {\n    const url = `${BASE_URL}/?key=${API_KEY}&q=${this.searchQuery}&image_type=photo&orientation=horizontal&safesearch=true&per_page=3&page=${this.page}`;\n    return fetch(url).then(response => response.json());\n  }\n\n  get query() {\n    return this.searchQuery;\n  }\n\n  set query(newQuery) {\n    this.searchQuery = newQuery;\n  }\n  \n\n  incrementPage() {\n    this.page += 1;\n  }\n\n  resetPage() {\n    this.page = 1;\n  }\n\n}\n","export default class LoadMoreBtn {\n  constructor({ selector, hidden = false }) {\n    this.refs = this.getRefs(selector);\n\n    hidden && this.hide();\n  }\n\n  getRefs(selector) {\n    const refs = {};\n    refs.button = document.querySelector(selector);\n    refs.label = refs.button.querySelector('.label');\n    refs.spinner = refs.button.querySelector('.spinner');\n\n    return refs;\n  }\n\n  enable() {\n    this.refs.button.disabled = false;\n    this.refs.label.textContent = 'Показать ещё';\n    this.refs.spinner.classList.add('is-hidden');\n  }\n\n  disable() {\n    this.refs.button.disabled = true;\n    this.refs.label.textContent = 'Загружаем...';\n    this.refs.spinner.classList.remove('is-hidden');\n  }\n\n  show() {\n    this.refs.button.classList.remove('is-hidden');\n  }\n\n  hide() {\n    this.refs.button.classList.add('is-hidden');\n  }\n}","import './sass/main.scss';\nimport getRefs from './js/getRefs.js';\n// import articlesTpl from './templates/articles.hbs';\nimport PictureApiService from './js/picture-service.js';\nimport LoadMoreBtn from './js/components/load-more-btn.js';\n\nconst refs = getRefs();\nconst pictureApiService = new PictureApiService();\nconst loadMoreBtn = new LoadMoreBtn({\n  selector: '[data-action=\"load-more\"]',\n  hidden: true,\n});\n// let page = 1;\n// const totalPage = 3;\n\nrefs.searchFormEl.addEventListener('submit', onSubmitSearchForm);\nloadMoreBtn.refs.button.addEventListener('click', onLoadMoreBtn);\n\n\n\nfunction onSubmitSearchForm(e) {\n  e.preventDefault();\n  // page = 1;\n\n  console.log(e.currentTarget.elements.searchQuery.value);\n  const searchQuery = e.currentTarget.elements.searchQuery.value;\n\n  pictureApiService.query = searchQuery;\n  pictureApiService.resetPage();\n  clearGalleryContainer()\n  fetchPictures();\n  loadMoreBtn.show();\n \n\n \n}\n  \nfunction fetchPictures() {\n  // page += 1;\n  loadMoreBtn.disable();\n  \n  return pictureApiService.fetchPictures()\n    .then(response => {\n      console.log(response);\n      const { hits } = response;\n      const page = response.totalHits / 150;\n      console.log(page)\n      pictureApiService.incrementPage();\n      loadMoreBtn.enable();\n      renderPicturesCard(hits)\n      console.log(hits);\n      if (pictureApiService.page > page) {\n        console.log('no more picture');\n        loadMoreBtn.hide();\n        return;\n      }\n\n    })\n    // .then(({ hits }) => {\n    //   console.log(hits);\n    //   pictureApiService.incrementPage();\n    //   return hits\n    // }).\n    // then(response => {\n    //   loadMoreBtn.enable();\n    //   return renderPicturesCard(response)\n    // });\n\n}\nfunction renderPicturesCard(countries) {\n  if (countries.length < 1) {\n    refs.gallery.innerHTML = \"\";\n    console.log(\"Sorry, there are no images matching your search query. Please try again.\");\n    return;\n  }\n  const markup = countries.map(country => `<div class=\"photo-card\">\n  <img src=\"${country.webformatURL}\" alt=\"${country.tags}\" loading=\"lazy\" />\n  <div class=\"info\">\n    <p class=\"info-item\">\n      <b>likes ${country.likes}</b>\n    </p>\n    <p class=\"info-item\">\n      <b>views ${country.views}</b>\n    </p>\n    <p class=\"info-item\">\n      <b>comments ${country.comments}</b>\n    </p>\n    <p class=\"info-item\">\n      <b>downloads ${country.downloads}</b>\n    </p>\n  </div>\n</div>`).join(\"\");\n  refs.gallery.insertAdjacentHTML('beforeend', markup);\n}\n// function appendPicturesMarkUp(pictures) {\n//   refs.gallery.insertAdjacentHTML('beforeend', articlesTpl(pictures));\n// }\nfunction onLoadMoreBtn() {\n\n  // if (page > totalPage) {\n  //   console.log('no more pictures');\n  //   loadMoreBtn.hide();\n  //   return;\n  // }\n  // console.log(page)\n  fetchPictures();\n\n}\nfunction clearGalleryContainer() {\n  refs.gallery.innerHTML = \"\";\n}"]}